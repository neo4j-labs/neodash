CREATE CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;
UNWIND [{_id:0, properties:{endpoint:"https://eratblob.blob.core.windows.net/dynabic-temp-attach/ferro-arch.png", name:"architecture", type:"image"}}, {_id:1, properties:{endpoint:"https://en.wikipedia.org/wiki/Variable-message_sign", name:"description", type:"html"}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:ATTACHMENT;
UNWIND [{_id:2, properties:{date:datetime('2023-06-02T12:49:59.542Z'), title:"", user:"neo4j", uuid:"eb887f11-ed35-4e13-b23e-4a3954e62a3d", version:"2.2", content:"{\n  \"title\": \"\",\n  \"version\": \"2.2\",\n  \"settings\": {\n    \"pagenumber\": 0,\n    \"editable\": true,\n    \"fullscreenEnabled\": false,\n    \"parameters\": {}\n  },\n  \"pages\": [\n    {\n      \"title\": \"Main Page\",\n      \"reports\": [\n        {\n          \"title\": \"Hi there ðŸ‘‹\",\n          \"query\": \"**This is your first dashboard!** \\n \\nYou can click (â‹®) to edit this report, or add a new report to get started. You can run any Cypher query directly from each report and render data in a variety of formats. \\n \\nTip: try _renaming_ this report by editing the title text. You can also edit the dashboard header at the top of the screen.\\n\\n\\n\",\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 0,\n          \"y\": 0,\n          \"type\": \"text\",\n          \"selection\": {},\n          \"settings\": {}\n        },\n        {\n          \"title\": \"\",\n          \"query\": \"MATCH (n)-[e]->(m) RETURN n,e,m LIMIT 20\\n\\n\\n\",\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 3,\n          \"y\": 0,\n          \"type\": \"graph\",\n          \"selection\": {\n            \"ASSET\": \"name\",\n            \"ANNOTATION\": \"(label)\"\n          },\n          \"settings\": {\n            \"enableEditing\": true\n          },\n          \"fields\": [\n            [\n              \"ASSET\",\n              \"name\",\n              \"layer\"\n            ],\n            [\n              \"ANNOTATION\",\n              \"endpoint\",\n              \"description\",\n              \"type\"\n            ]\n          ],\n          \"settingsOpen\": false,\n          \"collapseTimeout\": \"auto\",\n          \"advancedSettingsOpen\": true\n        },\n        {\n          \"title\": \"\",\n          \"query\": \"MATCH (n:`ANNOTATION`) \\nWHERE toLower(toString(n.`endpoint`)) CONTAINS toLower($input) \\nRETURN DISTINCT n.`endpoint` as value,  n.`endpoint` as display ORDER BY size(toString(value)) ASC LIMIT 5\",\n          \"settingsOpen\": true,\n          \"advancedSettingsOpen\": false,\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 6,\n          \"y\": 0,\n          \"type\": \"select\",\n          \"fields\": [],\n          \"selection\": {},\n          \"settings\": {\n            \"type\": \"Node Property\",\n            \"entityType\": \"ANNOTATION\",\n            \"propertyType\": \"endpoint\",\n            \"propertyTypeDisplay\": \"endpoint\",\n            \"parameterName\": \"neodash_annotation_endpoint\"\n          },\n          \"collapseTimeout\": \"auto\"\n        }\n      ]\n    }\n  ],\n  \"parameters\": {},\n  \"extensions\": {}\n}"}}, {_id:3, properties:{date:datetime('2023-06-02T21:11:47.299Z'), title:"Second dashboard", user:"neo4j", uuid:"eeb2e09c-f8bb-40db-a8f4-cf04fad3f9e9", version:"2.2", content:"{\n  \"title\": \"Second dashboard\",\n  \"version\": \"2.2\",\n  \"settings\": {\n    \"pagenumber\": 0,\n    \"editable\": true,\n    \"fullscreenEnabled\": false,\n    \"parameters\": {\n      \"neodash_annotation_endpoint\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/Anim1754_-_Flickr_-_NOAA_Photo_Library.jpg/1920px-Anim1754_-_Flickr_-_NOAA_Photo_Library.jpg\",\n      \"neodash_annotation_endpoint_display\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/Anim1754_-_Flickr_-_NOAA_Photo_Library.jpg/1920px-Anim1754_-_Flickr_-_NOAA_Photo_Library.jpg\"\n    }\n  },\n  \"pages\": [\n    {\n      \"title\": \"Main Page\",\n      \"reports\": [\n        {\n          \"title\": \"Hi there ðŸ‘‹\",\n          \"query\": \"**This is your first dashboard!** \\n \\nYou can click (â‹®) to edit this report, or add a new report to get started. You can run any Cypher query directly from each report and render data in a variety of formats. \\n \\nTip: try _renaming_ this report by editing the title text. You can also edit the dashboard header at the top of the screen.\\n\\n\\n\",\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 0,\n          \"y\": 0,\n          \"type\": \"text\",\n          \"selection\": {},\n          \"settings\": {},\n          \"settingsOpen\": false,\n          \"collapseTimeout\": \"auto\"\n        },\n        {\n          \"title\": \"\",\n          \"query\": \"MATCH (n)-[e]->(m) RETURN n,e,m LIMIT 20\\n\\n\\n\",\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 3,\n          \"y\": 0,\n          \"type\": \"graph\",\n          \"selection\": {\n            \"ASSET\": \"name\",\n            \"ANNOTATION\": \"description\"\n          },\n          \"settings\": {\n            \"enableEditing\": true\n          },\n          \"fields\": [\n            [\n              \"ASSET\",\n              \"name\",\n              \"layer\"\n            ],\n            [\n              \"ANNOTATION\",\n              \"endpoint\",\n              \"description\",\n              \"type\"\n            ]\n          ],\n          \"settingsOpen\": false,\n          \"collapseTimeout\": \"auto\",\n          \"advancedSettingsOpen\": true\n        },\n        {\n          \"title\": \"\",\n          \"query\": \"MATCH (n:`ANNOTATION`) \\nWHERE toLower(toString(n.`endpoint`)) CONTAINS toLower($input) \\nRETURN DISTINCT n.`endpoint` as value,  n.`endpoint` as display ORDER BY size(toString(value)) ASC LIMIT 5\",\n          \"settingsOpen\": false,\n          \"advancedSettingsOpen\": false,\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 6,\n          \"y\": 0,\n          \"type\": \"select\",\n          \"fields\": [],\n          \"selection\": {},\n          \"settings\": {\n            \"type\": \"Node Property\",\n            \"entityType\": \"ANNOTATION\",\n            \"propertyType\": \"endpoint\",\n            \"propertyTypeDisplay\": \"endpoint\",\n            \"parameterName\": \"neodash_annotation_endpoint\"\n          },\n          \"collapseTimeout\": \"auto\"\n        },\n        {\n          \"title\": \"\",\n          \"query\": \"match(n:ANNOTATION) return n.endpoint\\n\\n\\n\",\n          \"settingsOpen\": false,\n          \"advancedSettingsOpen\": false,\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 9,\n          \"y\": 0,\n          \"type\": \"image\",\n          \"fields\": [],\n          \"selection\": {},\n          \"settings\": {},\n          \"collapseTimeout\": \"auto\"\n        },\n        {\n          \"title\": \"\",\n          \"query\": \"match(n:ASSET) return n\\n\\n\\n\\n\",\n          \"settingsOpen\": false,\n          \"advancedSettingsOpen\": false,\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 0,\n          \"y\": 2,\n          \"type\": \"json\",\n          \"fields\": [],\n          \"selection\": {},\n          \"settings\": {},\n          \"collapseTimeout\": \"auto\"\n        }\n      ]\n    }\n  ],\n  \"parameters\": {},\n  \"extensions\": {}\n}"}}, {_id:12, properties:{date:datetime('2023-06-09T20:18:25.481Z'), title:"DYNABIC - MADT - FERRO", user:"neo4j", uuid:"d2d48523-9522-4c55-bca5-eab81c397a7a", version:"2.2", content:"{\n  \"title\": \"DYNABIC - MADT - FERRO\",\n  \"version\": \"2.2\",\n  \"settings\": {\n    \"pagenumber\": 0,\n    \"editable\": true,\n    \"fullscreenEnabled\": false,\n    \"parameters\": {\n      \"neodash_annotation_endpoint\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/Anim1754_-_Flickr_-_NOAA_Photo_Library.jpg/1920px-Anim1754_-_Flickr_-_NOAA_Photo_Library.jpg\",\n      \"neodash_annotation_endpoint_display\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/Anim1754_-_Flickr_-_NOAA_Photo_Library.jpg/1920px-Anim1754_-_Flickr_-_NOAA_Photo_Library.jpg\",\n      \"neodash_asset_layer\": \"Physical\",\n      \"neodash_asset_layer_display\": \"Physical\",\n      \"main_selected_node\": 11\n    }\n  },\n  \"pages\": [\n    {\n      \"title\": \"Main - All assets\",\n      \"reports\": [\n        {\n          \"title\": \"Hi there ðŸ‘‹\",\n          \"query\": \"match (a: ASSET)<--(b: ATTACHMENT)\\nreturn count(a) as assets, count(b) as attachments\",\n          \"width\": 3,\n          \"height\": 1,\n          \"x\": 0,\n          \"y\": 0,\n          \"type\": \"table\",\n          \"selection\": {},\n          \"settings\": {},\n          \"settingsOpen\": false,\n          \"collapseTimeout\": \"auto\",\n          \"fields\": [\n            \"assets\",\n            \"attachments\"\n          ]\n        },\n        {\n          \"title\": \"\",\n          \"query\": \"MATCH (n)-[e]->(m) RETURN n,e,m LIMIT 20\\n\\n\\n\",\n          \"width\": 4,\n          \"height\": 3,\n          \"x\": 3,\n          \"y\": 0,\n          \"type\": \"graph\",\n          \"selection\": {\n            \"ATTACHMENT\": \"name\",\n            \"ASSET\": \"name\",\n            \"DATASOURCE\": \"name\"\n          },\n          \"settings\": {\n            \"enableEditing\": true\n          },\n          \"fields\": [\n            [\n              \"ATTACHMENT\",\n              \"endpoint\",\n              \"name\",\n              \"type\"\n            ],\n            [\n              \"ASSET\",\n              \"name\",\n              \"layer\",\n              \"latitude\",\n              \"longitude\"\n            ],\n            [\n              \"DATASOURCE\",\n              \"endpoint\",\n              \"name\",\n              \"type\",\n              \"topic\"\n            ]\n          ],\n          \"settingsOpen\": false,\n          \"collapseTimeout\": 0,\n          \"advancedSettingsOpen\": true\n        },\n        {\n          \"title\": \"\",\n          \"query\": \"match(n:ANNOTATION) return n.endpoint\\n\\n\\n\",\n          \"settingsOpen\": false,\n          \"advancedSettingsOpen\": false,\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 7,\n          \"y\": 10,\n          \"type\": \"image\",\n          \"fields\": [],\n          \"selection\": {},\n          \"settings\": {},\n          \"collapseTimeout\": 0\n        },\n        {\n          \"title\": \"Attachment\",\n          \"query\": \"match(n:ATTACHMENT) \\nwhere id(n) = $main_selected_node \\nreturn n\\n\\n\\n\\n\",\n          \"settingsOpen\": false,\n          \"advancedSettingsOpen\": false,\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 7,\n          \"y\": 0,\n          \"type\": \"attachment\",\n          \"fields\": [],\n          \"selection\": {},\n          \"settings\": {},\n          \"collapseTimeout\": \"auto\"\n        },\n        {\n          \"title\": \"\",\n          \"query\": \"MATCH (n:`ASSET`) \\nWHERE toLower(toString(n.`layer`)) CONTAINS toLower($input) \\nRETURN DISTINCT n.`layer` as value,  n.`layer` as display ORDER BY size(toString(value)) ASC LIMIT 5\",\n          \"settingsOpen\": false,\n          \"advancedSettingsOpen\": false,\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 7,\n          \"y\": 8,\n          \"type\": \"select\",\n          \"fields\": [],\n          \"selection\": {},\n          \"settings\": {\n            \"type\": \"Node Property\",\n            \"entityType\": \"ASSET\",\n            \"propertyType\": \"layer\",\n            \"propertyTypeDisplay\": \"layer\",\n            \"parameterName\": \"neodash_asset_layer\"\n          },\n          \"collapseTimeout\": 0\n        },\n        {\n          \"title\": \"\",\n          \"query\": \"match(n:ATTACHMENT) \\nwhere id(n) = $main_selected_node \\nreturn n\\n\",\n          \"settingsOpen\": false,\n          \"advancedSettingsOpen\": false,\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 7,\n          \"y\": 6,\n          \"type\": \"json\",\n          \"fields\": [],\n          \"selection\": {},\n          \"settings\": {},\n          \"collapseTimeout\": 0\n        },\n        {\n          \"title\": \"Asset location\",\n          \"query\": \"MATCH (n)-[e]->(m) RETURN n,e,m LIMIT 20\\n\\n\\n\",\n          \"settingsOpen\": false,\n          \"advancedSettingsOpen\": false,\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 0,\n          \"y\": 1,\n          \"type\": \"map\",\n          \"fields\": [\n            [\n              \"ATTACHMENT\",\n              \"endpoint\",\n              \"name\",\n              \"type\"\n            ],\n            [\n              \"ASSET\",\n              \"name\",\n              \"layer\",\n              \"latitude\",\n              \"longitude\"\n            ],\n            [\n              \"DATASOURCE\",\n              \"endpoint\",\n              \"name\",\n              \"type\",\n              \"topic\"\n            ]\n          ],\n          \"selection\": {\n            \"ATTACHMENT\": \"name\",\n            \"ASSET\": \"name\",\n            \"DATASOURCE\": \"name\"\n          },\n          \"settings\": {},\n          \"collapseTimeout\": 0\n        },\n        {\n          \"title\": \"Data Source\",\n          \"query\": \"match(n:DATASOURCE) \\nwhere id(n) = $main_selected_node \\nreturn n\\n\\n\\n\",\n          \"settingsOpen\": false,\n          \"advancedSettingsOpen\": false,\n          \"width\": 3,\n          \"height\": 1,\n          \"x\": 7,\n          \"y\": 3,\n          \"type\": \"datasource\",\n          \"fields\": [],\n          \"selection\": {},\n          \"settings\": {},\n          \"collapseTimeout\": 0\n        },\n        {\n          \"title\": \"\",\n          \"query\": \"\\n\\n\\n\",\n          \"settingsOpen\": false,\n          \"advancedSettingsOpen\": false,\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 0,\n          \"y\": 4,\n          \"type\": \"attachment\",\n          \"fields\": [],\n          \"selection\": {},\n          \"settings\": {},\n          \"collapseTimeout\": 0\n        },\n        {\n          \"title\": \"\",\n          \"query\": \"match(n:ATTACHMENT) \\nwhere id(n) = $main_selected_node \\nreturn n\\n\\n\\n\",\n          \"settingsOpen\": false,\n          \"advancedSettingsOpen\": false,\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 3,\n          \"y\": 4,\n          \"type\": \"json\",\n          \"fields\": [],\n          \"selection\": {},\n          \"settings\": {},\n          \"collapseTimeout\": \"auto\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Asset in layers\",\n      \"reports\": [\n        {\n          \"title\": \"\",\n          \"query\": \"MATCH (n:`ASSET`) \\nWHERE toLower(toString(n.`layer`)) CONTAINS toLower($input) \\nRETURN DISTINCT n.`layer` as value,  n.`layer` as display ORDER BY size(toString(value)) ASC LIMIT 5\",\n          \"settingsOpen\": false,\n          \"advancedSettingsOpen\": false,\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 0,\n          \"y\": 0,\n          \"type\": \"select\",\n          \"fields\": [],\n          \"selection\": {},\n          \"settings\": {\n            \"type\": \"Node Property\",\n            \"entityType\": \"ASSET\",\n            \"propertyType\": \"layer\",\n            \"propertyTypeDisplay\": \"layer\",\n            \"parameterName\": \"neodash_asset_layer\"\n          },\n          \"collapseTimeout\": 0\n        },\n        {\n          \"title\": \"\",\n          \"query\": \"match (a: ASSET {layer:$neodash_asset_layer})\\noptional match (t:ATTACHMENT)-[c1]-(a)\\noptional match (b: ASSET {layer:$neodash_asset_layer})-[c2]-(a)\\nreturn a, b, t, c1, c2\\n\\n\",\n          \"settingsOpen\": false,\n          \"advancedSettingsOpen\": false,\n          \"width\": 3,\n          \"height\": 2,\n          \"x\": 3,\n          \"y\": 0,\n          \"type\": \"graph\",\n          \"fields\": [\n            [\n              \"ASSET\",\n              \"latitude\",\n              \"name\",\n              \"layer\",\n              \"longitude\"\n            ]\n          ],\n          \"selection\": {\n            \"ASSET\": \"name\"\n          },\n          \"settings\": {},\n          \"collapseTimeout\": 0\n        }\n      ]\n    }\n  ],\n  \"parameters\": {},\n  \"extensions\": {}\n}"}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:_Neodash_Dashboard;
UNWIND [{_id:4, properties:{name:"Scada", layer:"Functional"}}, {_id:5, properties:{name:"pmv1", layer:"Functional"}}, {_id:6, properties:{name:"pmv2", layer:"Functional"}}, {_id:7, properties:{latitude:59.654037, name:"Server1", layer:"Physical", longitude:10.741301}}, {_id:8, properties:{latitude:59.629083, name:"Switch1", layer:"Physical", longitude:10.7361537}}, {_id:9, properties:{latitude:59.606961, name:"Switch2", layer:"Physical", longitude:10.735244}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:ASSET;
UNWIND [{_id:10, properties:{endpoint:"https://httpbin.org/get", name:"testrest", type:"rest"}}, {_id:11, properties:{endpoint:"wss://test.mosquitto.org:8081/", topic:"whatever/top/it/is", name:"Events", type:"mqtt"}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:DATASOURCE;
UNWIND [{start: {_id:0}, end: {_id:4}, properties:{}}, {start: {_id:1}, end: {_id:5}, properties:{}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:AttachTo]->(end) SET r += row.properties;
UNWIND [{start: {_id:4}, end: {_id:7}, properties:{}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:DeployedOn]->(end) SET r += row.properties;
UNWIND [{start: {_id:10}, end: {_id:4}, properties:{}}, {start: {_id:11}, end: {_id:6}, properties:{}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:DataOf]->(end) SET r += row.properties;
UNWIND [{start: {_id:5}, end: {_id:4}, properties:{}}, {start: {_id:6}, end: {_id:4}, properties:{}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:ControlledBy]->(end) SET r += row.properties;
UNWIND [{start: {_id:5}, end: {_id:8}, properties:{}}, {start: {_id:8}, end: {_id:9}, properties:{}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:ConnectTo]->(end) SET r += row.properties;
MATCH (n:`UNIQUE IMPORT LABEL`)  WITH n LIMIT 100 REMOVE n:`UNIQUE IMPORT LABEL` REMOVE n.`UNIQUE IMPORT ID`;
DROP CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;
